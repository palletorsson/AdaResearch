[gd_scene load_steps=8 format=3 uid="uid://ca81g86tc5yh7"]

[ext_resource type="Script" uid="uid://bdfe0xxyj0ex8" path="res://algorithms/machinelearning/kmeansclustering/enhanced_kmeans.gd" id="1"]

[sub_resource type="Environment" id="Environment_1"]
background_mode = 1
background_color = Color(0.1, 0.1, 0.2, 1)
ambient_light_source = 2
ambient_light_color = Color(0.4, 0.4, 0.5, 1)
ambient_light_energy = 0.3

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_1"]
transparency = 1
albedo_color = Color(0.2, 0.2, 0.2, 0.3)
roughness = 0.8
rim_enabled = true
rim = 0.5

[sub_resource type="PlaneMesh" id="PlaneMesh_1"]
size = Vector2(50, 50)

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_1"]
bg_color = Color(0.1, 0.1, 0.1, 0.8)
border_width_left = 2
border_width_top = 2
border_width_right = 2
border_width_bottom = 2
border_color = Color(0.3, 0.3, 0.3, 1)
corner_radius_top_left = 8
corner_radius_top_right = 8
corner_radius_bottom_right = 8
corner_radius_bottom_left = 8

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_2"]
bg_color = Color(0.15, 0.15, 0.15, 0.9)
border_width_left = 2
border_width_top = 2
border_width_right = 2
border_width_bottom = 2
border_color = Color(0.4, 0.4, 0.4, 1)
corner_radius_top_left = 6
corner_radius_top_right = 6
corner_radius_bottom_right = 6
corner_radius_bottom_left = 6

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_3"]
bg_color = Color(0.2, 0.2, 0.3, 0.9)
border_width_left = 2
border_width_top = 2
border_width_right = 2
border_width_bottom = 2
border_color = Color(0.5, 0.5, 0.6, 1)
corner_radius_top_left = 5
corner_radius_top_right = 5
corner_radius_bottom_right = 5
corner_radius_bottom_left = 5

[node name="EnhancedKMeans" type="Node3D"]
script = ExtResource("1")
data_point_count = 80
iteration_speed = 1.2
convergence_threshold = 0.15
data_space_size = 22.0
natural_cluster_count = 4
cluster_spread = 3.5
noise_points_percentage = 0.15

[node name="Environment" type="Node3D" parent="."]

[node name="WorldEnvironment" type="WorldEnvironment" parent="Environment"]
environment = SubResource("Environment_1")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="Environment"]
transform = Transform3D(0.707107, -0.5, 0.5, 0, 0.707107, 0.707107, -0.707107, -0.5, 0.5, 0, 8, 0)
light_energy = 0.8
shadow_enabled = true
shadow_normal_bias = 1.0

[node name="FillLight" type="DirectionalLight3D" parent="Environment"]
transform = Transform3D(0.707107, 0.5, -0.5, 0, 0.707107, 0.707107, 0.707107, -0.5, 0.5, 0, 8, 0)
light_energy = 0.3

[node name="Camera3D" type="Camera3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 0.707107, 0.707107, 0, -0.707107, 0.707107, 0, 20, 30)
fov = 65.0
near = 0.1
far = 200.0

[node name="Ground" type="MeshInstance3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -6, 0)
material_override = SubResource("StandardMaterial3D_1")
mesh = SubResource("PlaneMesh_1")

[node name="UI" type="CanvasLayer" parent="."]

[node name="StatsPanel" type="Panel" parent="UI"]
anchors_preset = 1
anchor_left = 1.0
anchor_right = 1.0
offset_left = -300.0
offset_top = 20.0
offset_right = -20.0
offset_bottom = 180.0
theme_override_styles/panel = SubResource("StyleBoxFlat_1")

[node name="StatsContainer" type="VBoxContainer" parent="UI/StatsPanel"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = 15.0
offset_top = 15.0
offset_right = -15.0
offset_bottom = -15.0
grow_horizontal = 2
grow_vertical = 2
theme_override_constants/separation = 8

[node name="StatsTitle" type="Label" parent="UI/StatsPanel/StatsContainer"]
layout_mode = 2
theme_override_colors/font_color = Color(1, 1, 1, 1)
theme_override_font_sizes/font_size = 18
text = "K-Means Clustering"
horizontal_alignment = 1

[node name="IterationLabel" type="Label" parent="UI/StatsPanel/StatsContainer"]
layout_mode = 2
theme_override_colors/font_color = Color(0.9, 0.9, 0.9, 1)
text = "Iteration: 0"

[node name="DistanceLabel" type="Label" parent="UI/StatsPanel/StatsContainer"]
layout_mode = 2
theme_override_colors/font_color = Color(0.9, 0.9, 0.9, 1)
text = "Total Distance: 0.0"

[node name="StatusLabel" type="Label" parent="UI/StatsPanel/StatsContainer"]
layout_mode = 2
theme_override_colors/font_color = Color(0.9, 0.9, 0.9, 1)
text = "Status: Initializing"

[node name="ClusterInfo" type="Label" parent="UI/StatsPanel/StatsContainer"]
layout_mode = 2
theme_override_colors/font_color = Color(0.7, 0.7, 0.7, 1)
text = "Clusters: 4 | Points: 80"

[node name="ControlsPanel" type="Panel" parent="UI"]
anchors_preset = 2
anchor_top = 1.0
anchor_bottom = 1.0
offset_left = 20.0
offset_top = -200.0
offset_right = 320.0
offset_bottom = -20.0
theme_override_styles/panel = SubResource("StyleBoxFlat_2")

[node name="ControlsContainer" type="VBoxContainer" parent="UI/ControlsPanel"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = 15.0
offset_top = 15.0
offset_right = -15.0
offset_bottom = -15.0
grow_horizontal = 2
grow_vertical = 2
theme_override_constants/separation = 10

[node name="ControlsTitle" type="Label" parent="UI/ControlsPanel/ControlsContainer"]
layout_mode = 2
theme_override_colors/font_color = Color(1, 1, 1, 1)
theme_override_font_sizes/font_size = 16
text = "Controls"
horizontal_alignment = 1

[node name="ButtonsContainer" type="VBoxContainer" parent="UI/ControlsPanel/ControlsContainer"]
layout_mode = 2
theme_override_constants/separation = 8

[node name="RestartButton" type="Button" parent="UI/ControlsPanel/ControlsContainer/ButtonsContainer"]
layout_mode = 2
theme_override_font_sizes/font_size = 14
text = "üîÑ Restart (ESC)"

[node name="PauseButton" type="Button" parent="UI/ControlsPanel/ControlsContainer/ButtonsContainer"]
layout_mode = 2
theme_override_font_sizes/font_size = 14
text = "‚è∏Ô∏è Pause/Resume (ENTER)"

[node name="StepButton" type="Button" parent="UI/ControlsPanel/ControlsContainer/ButtonsContainer"]
layout_mode = 2
theme_override_font_sizes/font_size = 14
text = "‚è≠Ô∏è Step Forward (SPACE)"

[node name="ToggleContainer" type="VBoxContainer" parent="UI/ControlsPanel/ControlsContainer"]
layout_mode = 2
theme_override_constants/separation = 5

[node name="ConnectionsToggle" type="CheckBox" parent="UI/ControlsPanel/ControlsContainer/ToggleContainer"]
layout_mode = 2
theme_override_font_sizes/font_size = 12
text = "Show Connections"

[node name="VoronoiToggle" type="CheckBox" parent="UI/ControlsPanel/ControlsContainer/ToggleContainer"]
layout_mode = 2
theme_override_font_sizes/font_size = 12
text = "Show Voronoi Regions"

[node name="CentroidsToggle" type="CheckBox" parent="UI/ControlsPanel/ControlsContainer/ToggleContainer"]
layout_mode = 2
theme_override_font_sizes/font_size = 12
button_pressed = true
text = "Show Centroids"

[node name="ParametersPanel" type="Panel" parent="UI"]
offset_left = 20.0
offset_top = 20.0
offset_right = 300.0
offset_bottom = 260.0
theme_override_styles/panel = SubResource("StyleBoxFlat_3")

[node name="ParametersContainer" type="VBoxContainer" parent="UI/ParametersPanel"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = 15.0
offset_top = 15.0
offset_right = -15.0
offset_bottom = -15.0
grow_horizontal = 2
grow_vertical = 2
theme_override_constants/separation = 8

[node name="ParametersTitle" type="Label" parent="UI/ParametersPanel/ParametersContainer"]
layout_mode = 2
theme_override_colors/font_color = Color(1, 1, 1, 1)
theme_override_font_sizes/font_size = 16
text = "Parameters"
horizontal_alignment = 1

[node name="DataPointsContainer" type="HBoxContainer" parent="UI/ParametersPanel/ParametersContainer"]
layout_mode = 2

[node name="DataPointsLabel" type="Label" parent="UI/ParametersPanel/ParametersContainer/DataPointsContainer"]
layout_mode = 2
theme_override_colors/font_color = Color(0.9, 0.9, 0.9, 1)
theme_override_font_sizes/font_size = 12
text = "Data Points:"

[node name="DataPointsSpinBox" type="SpinBox" parent="UI/ParametersPanel/ParametersContainer/DataPointsContainer"]
layout_mode = 2
min_value = 20.0
max_value = 500.0
value = 80.0

[node name="ClustersContainer" type="HBoxContainer" parent="UI/ParametersPanel/ParametersContainer"]
layout_mode = 2

[node name="ClustersLabel" type="Label" parent="UI/ParametersPanel/ParametersContainer/ClustersContainer"]
layout_mode = 2
theme_override_colors/font_color = Color(0.9, 0.9, 0.9, 1)
theme_override_font_sizes/font_size = 12
text = "Clusters (K):"

[node name="ClustersSpinBox" type="SpinBox" parent="UI/ParametersPanel/ParametersContainer/ClustersContainer"]
layout_mode = 2
min_value = 2.0
max_value = 8.0
value = 4.0

[node name="SpeedContainer" type="HBoxContainer" parent="UI/ParametersPanel/ParametersContainer"]
layout_mode = 2

[node name="SpeedLabel" type="Label" parent="UI/ParametersPanel/ParametersContainer/SpeedContainer"]
layout_mode = 2
theme_override_colors/font_color = Color(0.9, 0.9, 0.9, 1)
theme_override_font_sizes/font_size = 12
text = "Speed:"

[node name="SpeedSpinBox" type="SpinBox" parent="UI/ParametersPanel/ParametersContainer/SpeedContainer"]
layout_mode = 2
min_value = 0.1
max_value = 5.0
step = 0.1
value = 1.2

[node name="DataModeContainer" type="VBoxContainer" parent="UI/ParametersPanel/ParametersContainer"]
layout_mode = 2

[node name="DataModeLabel" type="Label" parent="UI/ParametersPanel/ParametersContainer/DataModeContainer"]
layout_mode = 2
theme_override_colors/font_color = Color(0.9, 0.9, 0.9, 1)
theme_override_font_sizes/font_size = 12
text = "Data Generation:"

[node name="ClusteredDataToggle" type="CheckBox" parent="UI/ParametersPanel/ParametersContainer/DataModeContainer"]
layout_mode = 2
theme_override_font_sizes/font_size = 11
button_pressed = true
text = "Generate Clustered Data"

[node name="StepModeToggle" type="CheckBox" parent="UI/ParametersPanel/ParametersContainer/DataModeContainer"]
layout_mode = 2
theme_override_font_sizes/font_size = 11
text = "Step-by-Step Mode"

[node name="InstructionsPanel" type="Panel" parent="UI"]
anchors_preset = 3
anchor_left = 1.0
anchor_top = 1.0
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = -320.0
offset_top = -120.0
offset_right = -20.0
offset_bottom = -20.0
theme_override_styles/panel = SubResource("StyleBoxFlat_1")

[node name="InstructionsContainer" type="VBoxContainer" parent="UI/InstructionsPanel"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = 10.0
offset_top = 10.0
offset_right = -10.0
offset_bottom = -10.0
grow_horizontal = 2
grow_vertical = 2

[node name="InstructionsTitle" type="Label" parent="UI/InstructionsPanel/InstructionsContainer"]
layout_mode = 2
theme_override_colors/font_color = Color(1, 1, 1, 1)
theme_override_font_sizes/font_size = 14
text = "Instructions"
horizontal_alignment = 1

[node name="InstructionsText" type="Label" parent="UI/InstructionsPanel/InstructionsContainer"]
layout_mode = 2
theme_override_colors/font_color = Color(0.8, 0.8, 0.8, 1)
theme_override_font_sizes/font_size = 10
text = "‚Ä¢ Watch centroids move to cluster centers
‚Ä¢ Observe points change colors by cluster
‚Ä¢ Use controls to pause and step through
‚Ä¢ Adjust parameters to see effects
‚Ä¢ ESC: Restart | ENTER: Pause | SPACE: Step"
autowrap_mode = 2

[connection signal="ready" from="." to="." method="_ready"]
[connection signal="pressed" from="UI/ControlsPanel/ControlsContainer/ButtonsContainer/RestartButton" to="." method="restart_clustering"]
[connection signal="pressed" from="UI/ControlsPanel/ControlsContainer/ButtonsContainer/PauseButton" to="." method="_on_pause_toggled"]
[connection signal="pressed" from="UI/ControlsPanel/ControlsContainer/ButtonsContainer/StepButton" to="." method="_on_step_pressed"]
[connection signal="toggled" from="UI/ControlsPanel/ControlsContainer/ToggleContainer/ConnectionsToggle" to="." method="_on_connections_toggled"]
[connection signal="toggled" from="UI/ControlsPanel/ControlsContainer/ToggleContainer/VoronoiToggle" to="." method="_on_voronoi_toggled"]
[connection signal="toggled" from="UI/ControlsPanel/ControlsContainer/ToggleContainer/CentroidsToggle" to="." method="_on_centroids_toggled"]
[connection signal="value_changed" from="UI/ParametersPanel/ParametersContainer/DataPointsContainer/DataPointsSpinBox" to="." method="_on_data_points_changed"]
[connection signal="value_changed" from="UI/ParametersPanel/ParametersContainer/ClustersContainer/ClustersSpinBox" to="." method="_on_clusters_changed"]
[connection signal="value_changed" from="UI/ParametersPanel/ParametersContainer/SpeedContainer/SpeedSpinBox" to="." method="_on_speed_changed"]
[connection signal="toggled" from="UI/ParametersPanel/ParametersContainer/DataModeContainer/ClusteredDataToggle" to="." method="_on_clustered_data_toggled"]
[connection signal="toggled" from="UI/ParametersPanel/ParametersContainer/DataModeContainer/StepModeToggle" to="." method="_on_step_mode_toggled"]
